# 設計メモ

## 座標位置の確定

- 絶対位置のCSS表現
- 制約付きの配置
  - CSSで表現するかどうか
    - flex
    - float
- px単位で画面サイズを決定する
  - 横 (48,27) = (1152px, 648px)
  - 縦 (27,48) = (648px, 1152px)
  - canvasの解像度はどうする？
    - 画面サイズをスケールするときに問題が出る
    - 画面の重なり順の問題もある。
- HTML要素をほぼ静的に作るのはよい
- 問題は、CSSをすべて手書きするところにある

- 仮想的なscreenを考える。
  - camera / screen

- visualizerは(8,4) = (192px, 96px)を基準としている

- シルエット用のエリアは(14,25) = (336, 600)
  - 比率はw/h=0.56で、これは9/16=0.5625に近い

- 高解像度だと扱いづらいので、1000px弱に縮小して作業する。
  - 画像の縮小はPixelmatorでてきとうに
  - サイズと配置はOmniGraffleで調整する

- テープの元データサイズは 3406x2161
- 調整して(22,14) = (528px, 336px)

- シルエット
  - 左右反転させて右に6(12)

- タイトル画面の選択肢
  - 左右に1.5emつけて+3em
  - 5文字なら幅は8文字

- つづきから / CONTINUE
- はじめから / NEW GAME
- ロード / LOAD GAME

- 25x10.7821 / 48 = 5.615677083333333

- start: 720x480の画像を作る(3:2)
- bg: 1152, 648
- bg@2: 2304, 1296


## タスク

- [x] autosave => verse select
- [x] ラベル文字列→ラベルインデックスの表を作る
- [x] @verse命令か@scene命令を作る
  - @startとする
- [x] ダイアログ
- [x] クリック可能な要素にマウスカーソルを設定する
- [x] ダイアログのボイス対応
- [=] システムメニューを自動で閉じる
- [x] セーブ・ロード時のポーズ
- [x] セーブ・ロード時の停止
- [x] nextでwaitForDialogを見るか検討する
  - 一番最初で判定するべきでは？
- [x] ロードの実装
- [=] スクリーンのトランジションアニメーション
- [x] 段落のポーズの問題に対応する
  - 行の処理が終わっていた場合
- [x] BGMを決定可能にする。
  - [x] @music命令か@bgm命令を作る
  - [x] 合流点で一意に決定可能か検査する
  - [x] 短期間に音楽が切り替わる場合を考察する
- [x] タイトル画面に「最初から」「続きから」を付与する
- [=] オートセーブ情報から、タイトル画面で流す音楽を決められる
- [x] 戻る画面を決める
- [x] 既読管理
- [=] スタート直後に@startがはいるときに処理落ちする。
- [=] タイトル画面も絵文字をつける？
- [x] タイトル画面のクリックとonunlockを統合する。
- [x] copyrightのチェック
- [=] チュートリアルをBOOT CAMPにする。
- [x] 第一巻→一巻めの
- [x] nextの領域拡大
- [x] セーブ後の挙動の修正。
- [x] @enterの実装
- [x] finishをどうするか検討する
- [x] finish{bool}を作成する
- [x] copyrightの修正。
- [x] trailer -> preview
- [x] シナリオからロギングを触れるようにする
- [x] 1969はdiana 21
- [x] クレジットを作る
  - [x] グラフの開始点を確認する
  - [x] グラフの色を調整する
  - [x] テキストを作成する
  - [x] 自動スクロール
  - [x] vi05を使う
  - [x] 空のオーバーレイで自動スクロールを禁止する
- [x] オート
  - [=] アイコンをどうする。
- [x] スキップ
- [x] 労組モジュール
- [x] 既読スキップ
- [x] タイトルの音楽切り替え
- [x] オート・スキップをスクリーン遷移前に終わらせる
- [x] シナリオの仕様変更
  - [x] @start/@whenの同時指定を禁止する
  - [x] @systemを廃止して@dialogで代替する
- [=] スタート画面の入力待ち
- [x] システム設定
  - [x] システム設定リセット
  - [x] セーブデータリセット
  - [=] 既読リセット
- [x] 背景画像の調整
- [x] 軽量エディタ
  - [x] demeter.jsを再利用できるようにする
  - [x] エディタというより、昔のsketch1のように一括表示を行う。
  - [x] パスの切り替え
  - [x] ダイアログのボタン順序が逆。
- [x] シナリオパーサに@debugモードを作る（警告だけする）
- [x] D.preferences = { musicDir: "...", voiceDir: "..." }
- [x] 画面拡大率の上限

- [ ] クレジットの修正
  - [ ] アンロック
  - [x] グラフのかたちが変わったので対応
    - css min,maxを使えるか
  - [x] アニメーションの時間調整

- [ ] チュートリアルで質問できるようにする
- [ ] シルエットの位置微調整
- [ ] スタート画面の時間調整
- [ ] 複数タブで開いている場合の検出
- [ ] webworker
- [ ] 現在地の実装
- [ ] キャッシュをどうするか考える
  - 特にメモリキャッシュ
  - パスを変える
- [ ] ログを減らす
- [ ] ログがスクロールしない場合を調べる
  - 自前でスクロールする？
  - 隠れてる状態ではスクロールが効かない？
- [ ] トロフィー
  - クレジット画面で表示する
  - [ ] 既読率0%でED
- [ ] クレジット画面をいつでも見られるようにする
- [ ] iOSでスクロールが若干フレーム落ちする
- [ ] エラー通報
- [ ] バージョン更新の仕組み
- [ ] rosaのシルエットを用意
- [ ] D.ConsoleLogging
