# 設計メモ

## 座標位置の確定

- 絶対位置のCSS表現
- 制約付きの配置
  - CSSで表現するかどうか
    - flex
    - float
- px単位で画面サイズを決定する
  - 横 (48,27) = (1152px, 648px)
  - 縦 (27,48) = (648px, 1152px)
  - canvasの解像度はどうする？
    - 画面サイズをスケールするときに問題が出る
    - 画面の重なり順の問題もある。
- HTML要素をほぼ静的に作るのはよい
- 問題は、CSSをすべて手書きするところにある

- 仮想的なscreenを考える。
  - camera / screen

- visualizerは(8,4) = (192px, 96px)を基準としている

- シルエット用のエリアは(14,25) = (336, 600)
  - 比率はw/h=0.56で、これは9/16=0.5625に近い

- 高解像度だと扱いづらいので、1000px弱に縮小して作業する。
  - 画像の縮小はPixelmatorでてきとうに
  - サイズと配置はOmniGraffleで調整する

- テープの元データサイズは 3406x2161
- 調整して(22,14) = (528px, 336px)

- シルエット
  - 左右反転させて右に6(12)

- タイトル画面の選択肢
  - 左右に1.5emつけて+3em
  - 5文字なら幅は8文字

- つづきから / CONTINUE
- はじめから / NEW GAME
- ロード / LOAD GAME

## タスク

- [x] autosave => verse select
- [x] ラベル文字列→ラベルインデックスの表を作る
- [x] @verse命令か@scene命令を作る
  - @startとする
- [x] ダイアログ
- [x] クリック可能な要素にマウスカーソルを設定する
- [x] ダイアログのボイス対応
- [=] システムメニューを自動で閉じる
- [x] セーブ・ロード時のポーズ
- [x] セーブ・ロード時の停止
- [x] nextでwaitForDialogを見るか検討する
  - 一番最初で判定するべきでは？
- [x] ロードの実装
- [=] スクリーンのトランジションアニメーション
- [x] 段落のポーズの問題に対応する
  - 行の処理が終わっていた場合
- [x] BGMを決定可能にする。
  - [x] @music命令か@bgm命令を作る
  - [x] 合流点で一意に決定可能か検査する
  - [x] 短期間に音楽が切り替わる場合を考察する
- [x] タイトル画面に「最初から」「続きから」を付与する
- [=] オートセーブ情報から、タイトル画面で流す音楽を決められる
- [x] 戻る画面を決める
- [ ] エンドロールを作る
- [ ] finishをどうするか検討する
- [ ] 既読管理
- [ ] 複数タブで開いている場合の検出
- [ ] webworker
- [ ] オート
- [ ] スキップ
- [ ] @enterの実装
- [ ] シナリオからロギングを触れるようにする
- [ ] 現在地の実装
- [=] スタート直後に@startがはいるときに処理落ちする。
- [=] タイトル画面も絵文字をつける？
- [ ] キャッシュをどうするか考える
  - 特にメモリキャッシュ

