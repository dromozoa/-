<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&family=BIZ+UDPMincho&family=Share+Tech+Mono&family=VT323&display=swap" rel="stylesheet">
<style>
body {
  margin: 0;
}
.container {
  display: flex;
  overflow: auto;
  flex: none;
  width: 100%;
  height: 480px;
  scroll-snap-type: y mandatory;
  flex-flow: column nowrap;
}
.container:focus {
  outline: none;
}
.paragraph {
  scroll-snap-align: start;
  flex: none;
  width: 960px;
  height: 480px;
  font-family: "BIZ UDPMincho";
  font-size: 40px;
  line-height: 80px;
}
button {
  font-family: "Share Tech Mono";
  font-size: 64px;
}
</style>
<title>実験</title>
</head>
<body>
<div id="container" class="container" tabindex="0">

<div id="p0001" class="paragraph">
昭和七十四年七月、ボクはキミに出逢った。<br>
人類が滅亡するまでの、最期のひとつきの、これは物語だ。
</div>
<div id="p0002" class="paragraph">
<ruby>破局<rt>カタストロフ</rt></ruby>から十年。<br>
現在の世界人口は約二十億人と推定されている。<br>
人類の生存圏は三十パーセントを下まわった。
</div>
<div id="p0003" class="paragraph">
人類の大半は寒冷地に押しこめられた。<br>
冬が<ruby>屍者<rt>ゾンビ</rt></ruby>の脳髄を凍りつかせるから。<br>
海を要害に、封鎖と検疫に成功した島嶼もある。<br>
総じて人類は、南極以外の五大陸を喪いつつある。
</div>
<div id="p0004" class="paragraph">
日本国は国体を北海道以北に疎開した。<br>
一千万を切った人口の過半は、国家総動員体制の下、農業生産と石炭採掘に従事している。<br>
本州の生存者は四十万人内外と見られる。
</div>
<div id="p0005" class="paragraph">
一万人超の住民を抱える関東最大の根拠地、<ruby>本牧地区<rt>ホンモク・ディビジョン</rt></ruby>。<br>
資源調達師団隷下、<ruby>第一回収大隊<rt>スカベンジャーズ</rt></ruby>は京浜工業地帯を責任地域とする。
</div>
<div id="p0006" class="paragraph">
対咬戦闘服に円匙をかつぎ、キミは湾岸道路下のバラック集落を巡回する。<br>
キミのその日の相棒は<ruby>訓練士<rt>ハンドラー</rt></ruby>のユキヲだ。<br>
彼の犬は<ruby>屍者<rt>ゾンビ</rt></ruby>の屍臭を嗅ぐ。
</div>
<div id="p0007" class="paragraph">
決戦の噂、聞いたか。<br>
本牧埠頭に大量の物資が陸揚げされてる。<br>
猿島には重砲まで持ちこんでるんだとさ。<br>
まあ、おかげでオレたちも本物の肉にありつけるってわけだ。
</div>
<div id="p0008" class="paragraph">
その日は<ruby>屍者<rt>ゾンビ</rt></ruby>にも不審者にも遭遇しなかった。<br>
本部が置かれた中学校に戻り、下番したキミに大隊幕僚が声をかけた。<br>
キミを訪ねてきた者がいるという。
</div>
<div id="p0009" class="paragraph">
おい、あれ、魔人小隊じゃねえか。<br>
オマエ、なんちゅう厄ネタを抱えこんだんだ。<br>
オレは<ruby>逃げ<rt>フケ</rt></ruby>るぜ。<br>
あばよ。
</div>
<div id="p0010" class="paragraph">
透きとおるように白い肌の少女がいた。<br>
フードを目深にかぶった十二の兵が背後に従う。<br>
少女の深紅の瞳がきらめいた。
</div>

</div>
<div>
  <button id="prev">prev</button>
  <button id="next">next</button>
</div>
<script>
  document.addEventListener("DOMContentLoaded", (ev) => {
    const paragraph_id = (index) => {
      return "p" + ("000" + index.toFixed()).slice(-4)
    };

    let text = document.getElementById(paragraph_id(1));

    let observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        // console.log(entry.isIntersecting, entry.intersectionRatio, entry.target);
        if (entry.isIntersecting) {
          text = entry.target;
        }
      });
    }, {
      root: document.getElementById("container"),
      threshold: 0.5,
    });

    document.querySelectorAll(".paragraph").forEach(element => {
      observer.observe(element);
    });

    document.getElementById("prev").addEventListener("click", (ev) => {
      if (text) {
        const n = +text.id.match(/^p(\d+)$/)[1]
        if (n > 1) {
          document.getElementById(paragraph_id(n - 1)).scrollIntoView({ behavior: "smooth" });
        }
      }
    });

    document.getElementById("next").addEventListener("click", (ev) => {
      if (text) {
        const n = +text.id.match(/^p(\d+)$/)[1]
        if (n < 10) {
          document.getElementById(paragraph_id(n + 1)).scrollIntoView({ behavior: "smooth" });
        }
      }
    });
  });
</script>
</body>
</html>
