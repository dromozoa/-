<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&family=BIZ+UDPMincho&family=Share+Tech+Mono&family=VT323&display=swap" rel="stylesheet">
<style>
body {
  margin: 0;
}
.container {
  display: flex;
  overflow: auto;
  flex: none;
  width: 100%;
  height: 480px;
  scroll-snap-type: y mandatory;
  flex-flow: column nowrap;
}
.container:focus {
  outline: none;
}
.paragraph {
  scroll-snap-align: start;
  flex: none;
  width: 960px;
  height: 480px;
  font-family: "BIZ UDPMincho";
  font-size: 40px;
  line-height: 80px;
}
button {
  font-family: "Share Tech Mono";
  font-size: 64px;
}
</style>
<title>実験</title>
</head>
<body>
<div id="container" class="container" tabindex="0">

<div id="p0001" class="paragraph">
<span id="n0001" class="line">昭和七十四年七月、ボクはキミに出逢った。</span><br>
<span id="n0002" class="line">人類が滅亡するまでの、最期のひとつきの、これは物語だ。</span>
</div>
<div id="p0002" class="paragraph">
<span id="n0003" class="line"><ruby>破局<rt>カタストロフ</rt></ruby>から十年。</span><br>
<span id="n0004" class="line">現在の世界人口は約二十億人と推定されている。</span><br>
<span id="n0005" class="line">人類の生存圏は三十パーセントを下まわった。</span>
</div>
<div id="p0003" class="paragraph">
<span id="n0006" class="line">人類の大半は寒冷地に押しこめられた。</span><br>
<span id="n0007" class="line">冬が<ruby>屍者<rt>ゾンビ</rt></ruby>の脳髄を凍りつかせるから。</span><br>
<span id="n0008" class="line">海を要害に、封鎖と検疫に成功した島嶼もある。</span><br>
<span id="n0009" class="line">総じて人類は、南極以外の五大陸を喪いつつある。</span>
</div>
<div id="p0004" class="paragraph">
<span id="n0010" class="line">日本国は国体を北海道以北に疎開した。</span><br>
<span id="n0011" class="line">一千万を切った人口の過半は、国家総動員体制の下、農業生産と石炭採掘に従事している。</span><br>
<span id="n0012" class="line">本州の生存者は四十万人内外と見られる。</span>
</div>
<div id="p0005" class="paragraph">
<span id="n0013" class="line">一万人超の住民を抱える関東最大の根拠地、<ruby>本牧地区<rt>ホンモク・ディビジョン</rt></ruby>。</span><br>
<span id="n0014" class="line">資源調達師団隷下、<ruby>第一回収大隊<rt>スカベンジャーズ</rt></ruby>は京浜工業地帯を責任地域とする。</span>
</div>
<div id="p0006" class="paragraph">
<span id="n0015" class="line">対咬戦闘服に円匙をかつぎ、キミは湾岸道路下のバラック集落を巡回する。</span><br>
<span id="n0016" class="line">キミのその日の相棒は<ruby>訓練士<rt>ハンドラー</rt></ruby>のユキヲだ。</span><br>
<span id="n0017" class="line">彼の犬は<ruby>屍者<rt>ゾンビ</rt></ruby>の屍臭を嗅ぐ。</span>
</div>
<div id="p0007" class="paragraph">
<span id="n0018" class="line">決戦の噂、聞いたか。</span><br>
<span id="n0019" class="line">本牧埠頭に大量の物資が陸揚げされてる。</span><br>
<span id="n0020" class="line">猿島には重砲まで持ちこんでるんだとさ。</span><br>
<span id="n0021" class="line">まあ、おかげでオレたちも本物の肉にありつけるってわけだ。</span>
</div>
<div id="p0008" class="paragraph">
<span id="n0022" class="line">その日は<ruby>屍者<rt>ゾンビ</rt></ruby>にも不審者にも遭遇しなかった。</span><br>
<span id="n0023" class="line">本部が置かれた中学校に戻り、下番したキミに大隊幕僚が声をかけた。</span><br>
<span id="n0024" class="line">キミを訪ねてきた者がいるという。</span>
</div>
<div id="p0009" class="paragraph">
<span id="n0025" class="line">おい、あれ、魔人小隊じゃねえか。</span><br>
<span id="n0026" class="line">オマエ、なんちゅう厄ネタを抱えこんだんだ。</span><br>
<span id="n0027" class="line">オレは<ruby>逃げ<rt>フケ</rt></ruby>るぜ。</span><br>
<span id="n0028" class="line">あばよ。</span>
</div>
<div id="p0010" class="paragraph">
<span id="n0029" class="line">透きとおるように白い肌の少女がいた。</span><br>
<span id="n0030" class="line">フードを目深にかぶった十二の兵が背後に従う。</span><br>
<span id="n0031" class="line">少女の深紅の瞳がきらめいた。</span>
</div>
<div id="p0011" class="paragraph">
<span id="n0032" class="line">資源調達師団特殊検索群、アリス大佐だ。</span><br>
<span id="n0033" class="line">これは辞令。こっちは階級章。</span><br>
<span id="n0034" class="line">特殊検索群少尉に任ずる、ってね。</span><br>
<span id="n0035" class="line">たった今から、キミはボクの部下だ。</span>
</div>
<div id="p0012" class="paragraph">
<span id="n0036" class="line">今後ともよろしく。</span><br>
<span id="n0037" class="line">そうだ。</span><br>
<span id="n0038" class="line">キミの拳銃を見せてほしい。</span>
</div>

</div>
<div>
  <button id="prev">prev</button>
  <button id="next">next</button>
  <button id="voice">voice</button>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js" integrity="sha512-6+YN/9o9BWrk6wSfGxQGpt3EUK6XeHi6yeHV+TYD2GR0Sj/cggRpXr1BrAQf0as6XslxomMUxXp2vIl+fv0QRA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
  document.addEventListener("DOMContentLoaded", (ev) => {
    const paragraph_id = (index) => {
      return "p" + ("000" + index.toFixed()).slice(-4)
    };

    let text = document.getElementById(paragraph_id(1));

    let observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        // console.log(entry.isIntersecting, entry.intersectionRatio, entry.target);
        if (entry.isIntersecting) {
          text = entry.target;
        }
      });
    }, {
      root: document.getElementById("container"),
      threshold: 0.5,
    });

    document.querySelectorAll(".paragraph").forEach(element => {
      observer.observe(element);
    });

    document.getElementById("prev").addEventListener("click", (ev) => {
      if (text) {
        const n = +text.id.match(/^p(\d+)$/)[1]
        if (n > 1) {
          document.getElementById(paragraph_id(n - 1)).scrollIntoView({ behavior: "smooth" });
        }
      }
    });

    document.getElementById("next").addEventListener("click", (ev) => {
      if (text) {
        const n = +text.id.match(/^p(\d+)$/)[1]
        if (n < 10) {
          document.getElementById(paragraph_id(n + 1)).scrollIntoView({ behavior: "smooth" });
        }
      }
    });

    document.getElementById("voice").addEventListener("click", (ev) => {
      if (text) {
        const voices = [];
        text.querySelectorAll(".line").forEach(element => {
          const n = element.id.match(/^n(\d+)$/)[1];
          voices.push(new Howl({ src: [ n + ".webm", n + ".mp3" ], html5: true, rate: 1.2 }));
        });
        voices.forEach((voice, i) => {
          if (i + 1 < voices.length) {
            voice.once("end", () => {
              voices[i + 1].play();
            });
          }
        });
        voices[0].play();
      }
    });
  });
</script>
</body>
</html>
